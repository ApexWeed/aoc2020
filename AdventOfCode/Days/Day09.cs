using System;
using System.Collections.Generic;
using System.Globalization;
using System.Linq;

namespace AdventOfCode.Days
{
    public class Day09 : IDay
    {
        public int Day => 9;
        public void RunPart1(bool silent)
        {
            Console.WriteLine(FindInvalid(Input, 25));
        }

        private long FindInvalid(long[] input, int length)
        {
            var preamble = new Queue<long>();
            foreach (var number in input)
            {
                if (preamble.Count < length)
                {
                    preamble.Enqueue(number);
                    continue;
                }

                var valid = CheckValidity(preamble, number);
                if (!valid)
                {
                    return number;
                }

                preamble.Enqueue(number);
                preamble.Dequeue();
            }

            throw new Exception();
        }

        private bool CheckValidity(IEnumerable<long> preamble, long number)
        {
            var alternate = preamble.Select(n => number - n).ToHashSet();
            return preamble.Any(p => alternate.Contains(p));
        }

        public void RunPart2(bool silent)
        {
            var invalid = FindInvalid(Input, 25);

            for (var i = 0; i < Input.Length; i++)
            {
                var sum = 0L;
                for (var j = i; j < Input.Length; j++)
                {
                    sum += Input[j];
                    if (sum > invalid)
                        break;

                    if (sum == invalid)
                    {
                        var range = Input.Skip(i).Take(j - i + 1);
                        Console.WriteLine(range.Min());
                        Console.WriteLine(range.Max());
                        return;
                    }
                }
            }

            Console.WriteLine("asdf");
        }

        private long[] Debug =
        {
            35,
            20,
            15,
            25,
            47,
            40,
            62,
            55,
            65,
            95,
            102,
            117,
            150,
            182,
            127,
            219,
            299,
            277,
            309,
            576,
        };

        private long[] Input =
        {
44L,
17L,
23L,
42L,
25L,
26L,
6L,
45L,
30L,
8L,
15L,
39L,
28L,
16L,
20L,
50L,
14L,
47L,
27L,
7L,
13L,
46L,
34L,
24L,
32L,
19L,
21L,
31L,
22L,
23L,
33L,
41L,
92L,
29L,
30L,
70L,
45L,
26L,
35L,
28L,
48L,
50L,
20L,
36L,
27L,
37L,
53L,
42L,
49L,
39L,
44L,
43L,
61L,
51L,
68L,
46L,
73L,
138L,
47L,
56L,
69L,
63L,
55L,
57L,
96L,
64L,
59L,
79L,
66L,
108L,
76L,
106L,
95L,
88L,
82L,
119L,
97L,
192L,
93L,
103L,
137L,
135L,
102L,
104L,
111L,
112L,
150L,
123L,
116L,
125L,
130L,
249L,
268L,
142L,
356L,
191L,
196L,
181L,
227L,
288L,
303L,
190L,
329L,
213L,
205L,
206L,
215L,
498L,
216L,
313L,
228L,
239L,
241L,
255L,
272L,
311L,
347L,
441L,
323L,
371L,
377L,
403L,
386L,
396L,
420L,
395L,
480L,
488L,
418L,
411L,
617L,
455L,
444L,
467L,
483L,
469L,
494L,
636L,
527L,
694L,
634L,
724L,
700L,
947L,
1641L,
763L,
781L,
782L,
898L,
806L,
1035L,
829L,
855L,
2422L,
880L,
899L,
911L,
1021L,
1547L,
963L,
996L,
1130L,
1221L,
1630L,
1328L,
1334L,
1424L,
1463L,
1544L,
1545L,
1563L,
1587L,
2399L,
1704L,
1635L,
2304L,
4126L,
1735L,
1779L,
1932L,
1810L,
1959L,
5671L,
2093L,
3723L,
3150L,
2351L,
2878L,
2662L,
3990L,
2758L,
2887L,
3279L,
3323L,
3108L,
3198L,
5507L,
3370L,
3663L,
5986L,
9633L,
3514L,
6083L,
3589L,
3742L,
3769L,
4052L,
4444L,
4851L,
5013L,
5109L,
6401L,
6649L,
5420L,
5645L,
11662L,
6967L,
6477L,
8755L,
6306L,
10135L,
6884L,
7566L,
7103L,
7256L,
7283L,
8527L,
7331L,
11411L,
12010L,
9864L,
10271L,
9295L,
12365L,
10122L,
17418L,
11065L,
13580L,
18765L,
11951L,
12783L,
24793L,
21246L,
32124L,
13190L,
26021L,
16861L,
16551L,
14359L,
15783L,
15810L,
16626L,
17195L,
27194L,
25973L,
19159L,
19417L,
20360L,
25141L,
21187L,
30131L,
30441L,
24734L,
26310L,
27142L,
41988L,
32334L,
29741L,
35227L,
27549L,
31554L,
32978L,
30142L,
49586L,
31593L,
34969L,
33821L,
43168L,
38576L,
39519L,
40604L,
39777L,
49875L,
45921L,
47497L,
72231L,
51044L,
51876L,
53452L,
54691L,
57290L,
57691L,
59103L,
66799L,
89660L,
61696L,
67947L,
61735L,
65414L,
66562L,
68790L,
72397L,
78095L,
80381L,
87016L,
85698L,
97372L,
97797L,
93418L,
98541L,
110979L,
108735L,
120666L,
108143L,
133361L,
114981L,
116794L,
164359L,
123431L,
127110L,
226779L,
146885L,
127149L,
131976L,
135352L,
141187L,
150492L,
224937L,
297720L,
197995L,
179116L,
195169L,
201561L,
214084L,
206684L,
231775L,
216878L,
228809L,
258635L,
243943L,
456630L,
240225L,
262462L,
282468L,
254259L,
385800L,
259125L,
352086L,
267328L,
276539L,
393200L,
329608L,
374285L,
377111L,
380677L,
588733L,
453804L,
486034L,
423562L,
435493L,
652371L,
445687L,
609486L,
484168L,
494484L,
779000L,
981979L,
513384L,
521587L,
644439L,
526453L,
535664L,
628625L,
713015L,
606147L,
1150212L,
1322501L,
1508432L,
869249L,
804239L,
1226399L,
859055L,
881180L,
907730L,
948877L,
1138923L,
1224687L,
1503494L,
978652L,
1057251L,
1142009L,
1239468L,
1407633L,
1048040L,
1484541L,
1164289L,
1432864L,
1792914L,
2556472L,
2464510L,
1750429L,
1753116L,
1673488L,
1685419L,
1830057L,
1740235L,
1766785L,
1788910L,
1996917L,
1927529L,
2026692L,
3074732L,
2911127L,
2212329L,
3236385L,
2190049L,
2840954L,
2597153L,
2480904L,
2957203L,
3118283L,
3106352L,
4337388L,
3358907L,
3413723L,
3440273L,
3618967L,
3425654L,
3452204L,
3924446L,
5103269L,
3978959L,
3716439L,
5642253L,
4787202L,
4216741L,
5264781L,
6429070L,
5833538L,
4670953L,
5031003L,
9358692L,
10620740L,
6465259L,
6063555L,
6224635L,
8766161L,
13553363L,
7032690L,
6853996L,
9858994L,
6877858L,
7350100L,
17005567L,
7640885L,
7695398L,
7933180L,
11649619L,
10429455L,
10295784L,
19979432L,
9701956L,
10504491L,
10734508L,
12063693L,
11255638L,
12288190L,
13731854L,
12528814L,
30558930L,
41293438L,
18917689L,
13886686L,
13910548L,
14204096L,
14227958L,
14518743L,
21945403L,
15336283L,
17342841L,
18951036L,
17635136L,
19997740L,
20131411L,
20206447L,
20436464L,
22792681L,
32494637L,
21990146L,
23319331L,
23784452L,
26492286L,
33469779L,
35900694L,
28090782L,
28432054L,
27797234L,
28114644L,
28138506L,
28722839L,
28746701L,
29855026L,
57652260L,
26134589L,
46065680L,
37841583L,
37632876L,
40204187L,
40337858L,
52931101L,
45309477L,
44782827L,
45774598L,
47103783L,
49453920L,
49919041L,
52626875L,
53931823L,
54225371L,
54273095L,
69060697L,
54249233L,
56837483L,
74032316L,
54857428L,
83616181L,
70917416L,
63767465L,
83151060L,
83407474L,
75474459L,
77837063L,
95195286L,
104192136L,
107180334L,
90092304L,
187599610L,
99706421L,
103941266L,
99372961L,
102545916L,
106558698L,
108157194L,
294779944L,
128305411L,
180591014L,
109106661L,
120604948L,
186162097L,
118624893L,
139241924L,
134684881L,
208479622L,
319832938L,
161244537L,
229711609L,
173032349L,
185287590L,
227678372L,
196651002L,
189465265L,
315275895L,
199079382L,
201918877L,
228762142L,
288748208L,
316636816L,
217263855L,
239229841L,
243791542L,
227731554L,
248348585L,
259846872L,
320543770L,
455409926L,
397944887L,
400998259L,
703758511L,
334276886L,
346532127L,
425413144L,
388544647L,
441148718L,
386116267L,
391384142L,
523742151L,
416343237L,
438309223L,
446025997L,
1149784508L,
466961395L,
444995409L,
456493696L,
635175684L,
548275324L,
476080139L,
508195457L,
580390642L,
775425604L,
813957791L,
680809013L,
1021539360L,
1566127745L,
720393153L,
735076774L,
774660914L,
779928789L,
777500409L,
836379551L,
1259983788L,
883304632L,
1588618705L,
1554589703L,
891021406L,
943041534L,
901489105L,
964689153L,
984275596L,
1440769292L,
1253580548L,
1228588610L,
1088586099L,
1261199655L,
1494766804L,
1517188564L,
1681417894L,
1455469927L,
1495054067L,
1497893562L,
1927317130L,
1552161323L,
1742189562L,
2458918303L,
2204241189L,
1774326038L,
1784793737L,
2817207315L,
1792510511L,
1834062940L,
1844530639L,
3534700073L,
2684058537L,
2726482172L,
3457821737L,
2317174709L,
3269092842L,
3423607456L,
2716669582L,
3608388978L,
3259378126L,
2950523994L,
2953363489L,
6992521810L,
3815068271L,
3294350885L,
3577304248L,
10261614652L,
5421834887L,
4048771828L,
5442451918L,
3618856677L,
5882834768L,
3626573451L,
4797894128L,
5586267551L,
5774996446L,
5267698703L,
5033844291L,
5270538198L,
7863840099L,
5667193576L,
5670033071L,
8529916324L,
5903887483L,
6579936940L,
9288889748L,
8375198376L,
6871655133L,
7196160925L,
6913207562L,
7203877699L,
7245430128L,
7667628505L,
7675345279L,
11256300622L,
8416750805L,
8897111649L,
14539283638L,
9831738419L,
10304382489L,
10301542994L,
22914482014L,
10701037867L,
18452461547L,
11337226647L,
13334822081L,
15401571457L,
16791949181L,
22623711829L,
13451592073L,
14067816058L,
19198654643L,
13784862695L,
14871506204L,
14117085261L,
19004855152L,
14920775407L,
21460207974L,
16092096084L,
25240321505L,
23753135067L,
24703244623L,
20532776286L,
24768853925L,
21641609136L,
21002580861L,
22038264514L,
24035859948L,
35874087065L,
28988591465L,
27119684776L,
27236454768L,
27519408131L,
27568677334L,
27852678753L,
44568636234L,
28656368899L,
59909947013L,
29037860668L,
30209181345L,
33925630559L,
31012871491L,
40795340707L,
36624872370L,
61045315335L,
55089133521L,
41535357147L,
51850790481L,
43679873650L,
42644189997L,
50040441529L,
46074124462L,
51155544724L,
54688362110L,
56507999596L,
54639092907L,
54755862899L,
55088085465L,
55421356087L,
56509047652L,
64134811904L,
57694229567L,
59247042013L,
61222052836L,
66834053715L,
64938502050L,
105129575050L,
115861145743L,
78160229517L,
84179547144L,
85215230797L,
88718314459L,
86324063647L,
105461797616L,
100338419564L,
96114565991L,
100713217369L,
105794637631L,
111930403739L,
109394955806L,
113115585654L,
109843948364L,
110509441552L,
206175014985L,
114203277219L,
171066001200L,
116941271580L,
120469094849L,
128056106551L,
183775325295L,
151262565697L,
180294113135L,
222510541460L,
200648718198L,
173933545256L,
171539294444L,
175042378106L,
220807514413L,
196452985555L,
196827783360L,
201909203622L,
206507855000L,
215189593437L,
221325359545L,
230056857234L,
300763207984L,
220353389916L,
244997378131L,
231144548799L,
265465842916L,
237410366429L,
248525201400L,
375691096304L,
364069438430L,
325196110953L,
485935567829L,
345472839700L,
346581672550L,
348975923362L,
482407744560L,
371870161466L,
539111816536L,
403335638360L,
620395362866L,
398736986982L,
423234563167L,
451497938715L,
496610391715L,
478582058634L,
450410247150L,
468554915228L,
457763756345L,
648333016491L,
687820613579L,
723345934258L,
562606477382L,
573721312353L,
670668950653L,
671777783503L,
674172034315L,
692054512250L,
694448763062L,
770607148448L,
1036796536941L,
775205799826L,
795104724633L,
1007666731764L,
1446983583329L,
1183001840248L,
919844954882L,
928992305784L,
901908185865L,
947136973862L,
2111994146032L,
1024131559503L,
1576080220180L,
1340387528741L,
1136327789735L,
1415400446508L,
1345949817818L,
1233275428035L,
1244390263006L,
1386503275312L,
1363832295753L,
1681838766079L,
1462661660698L,
1465055911510L,
1545812948274L,
2315495581096L,
1570310524459L,
1697012910498L,
1821753140747L,
2102846795130L,
1830900491649L,
3730896027604L,
1849045159727L,
1926039745368L,
2706638314194L,
2160459349238L,
2257406987538L,
2369603217770L,
2380718052741L,
2477665691041L,
2579225245853L,
2590340080824L,
2779088376309L,
4044281157363L,
2750335571065L,
4106452147265L,
2927717572208L,
3008474608972L,
3546058070225L,
3803219935812L,
3924599935877L,
3267323434957L,
4505264991221L,
3652653632396L,
3679945651376L,
3756940237017L,
4555683473921L,
6631238250071L,
5915661287995L,
4417866336776L,
4530062567008L,
4627010205308L,
5378077826742L,
4858383743782L,
5056890936894L,
5169565326677L,
5529423947374L,
9840261223872L,
5758810180037L,
6195041007165L,
7332599283772L,
10822051212473L,
6275798043929L,
6947269086333L,
7409593869413L,
7191923370834L,
10459246805791L,
10586314884268L,
7436885888393L,
8097811988152L,
8973549810697L,
14524522654606L,
8947928903784L,
9044876542084L,
9276250080558L,
9157072772316L,
9485393949090L,
11805652830115L,
9915274680676L,
10226456263571L,
10928375506714L,
16410435699090L,
11953851187202L,
12034608223966L,
14139192457167L,
13223067130262L,
15432870816245L,
13467721414763L,
18981877310299L,
14601517240247L,
14628809259227L,
15534697876545L,
16384814792177L,
16481762430477L,
18130622583013L,
17921478714481L,
22512597956847L,
17992805445868L,
27467479040211L,
18433322852874L,
19383529035887L,
19400668629766L,
22962983730680L,
22882226693916L,
21154831770285L,
23988459411168L,
25176918317464L,
27362259587429L,
25257675354228L,
27824584370509L,
29002419291308L,
35980319371610L,
28069238655010L,
29230326499474L,
35756349010532L,
35914284160349L,
35865291466364L,
34474567876345L,
34403241144958L,
41913266586613L,
61870720185169L,
37833991482640L,
48613855535361L,
37816851888761L,
58988823252925L,
63825587665542L,
40555500400051L,
50157251061593L,
44037058464201L,
46412507124513L,
52057698066178L,
50434593671692L,
52619934941657L,
53082259724737L,
55893823025519L,
72237232627598L,
57299565154484L,
63633567644432L,
76420791866415L,
71621640476896L,
68877809021303L,
70268532611322L,
72220093033719L,
79730118475374L,
75650843371401L,
84246498607153L,
78372352288812L,
81853910352962L,
90712751461644L,
84592558864252L,
121497743962960L,
86968007524564L,
90449565588714L,
94471652135893L,
96847100796205L,
102492291737870L,
103054528613349L,
        };
    }
}
